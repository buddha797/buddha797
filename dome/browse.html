<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="bootstrap.min.css" >
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    

    <script src="https://code.jquery.com/jquery-3.1.0.js"></script>
    <!-- <link href="https://nightly.datatables.net/css/jquery.dataTables.css" rel="stylesheet" type="text/css" /> -->
    <!-- <script src="https://cdn.datatables.net/1.10.13/js/jquery.dataTables.js"></script> -->
    <script src="https://cdn.datatables.net/select/1.2.1/js/dataTables.select.min.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.20/fh-3.1.6/kt-2.5.1/r-2.2.3/datatables.min.css"/>
 
    <script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.20/fh-3.1.6/kt-2.5.1/r-2.2.3/datatables.min.js"></script>
    <script language="javascript" >

    var whipreporttitle;
    var whipreportdate;
    var legislativeday;
    var whipreportversion;
    var whipreportlastupdated;
    var whipreportmessage;
    var whipreportruletypes;
    var whipreporttabletitle;

        $(document).ready(function () {
            $( "#browseview" ).hide();
            $( "#aboutview" ).hide();

        var table = $('#example').DataTable({
            //"processing" : true,
                    "ajax" : {
                        "url" : "https://script.google.com/macros/s/AKfycbxYDyGnI5jfvWPys5ZxFHw02kwjswfv5FWXaZjZzK8yK6Z7IFd-/exec?id=11OXJaPQ4A01lCstNPAs6jOgAI1ZJHepxcqYdDZfF8Rk&sheet=Sheet1",
                        dataSrc : 'records'
                    },
            "deferRender": true,
            responsive: true,
            select:"single",
            "lengthMenu": [ [10, 25, 50, -1], [10, 25, 50, "All"] ],
            "pageLength": -1,

            "columns": [
                {
                    "className": 'details-control',
                    "orderable": false,
                    "data": null,
                    "defaultContent": '',
                    "render": function () {
                        return '<i class="fa fa-plus-square" aria-hidden="true"></i>';
                    },
                    width:"15px"
                },
                { "data": "Type" },
                { "data": "Number" },
                { "data": "Title" },
                { "data": "Sponsor1" },
                { "data": "Status" },
                { "data": "Summary",
                    "visible" : false
                },
                { "data": "Text",
                    "visible" : false
                }
            ],
            "order": [[1, 'dsc']]
        });
        
        var reporttable = $('#reporttable').DataTable({
            //"processing" : true,
                    "ajax" : {
                        "url" : "https://script.google.com/macros/s/AKfycbxYDyGnI5jfvWPys5ZxFHw02kwjswfv5FWXaZjZzK8yK6Z7IFd-/exec?id=11OXJaPQ4A01lCstNPAs6jOgAI1ZJHepxcqYdDZfF8Rk&sheet=Whip Report Data GRACE ONLY",
                        dataSrc : 'records'
                    },
            "deferRender": true,
            select:"single",
            responsive: true,
            "lengthMenu": [ [10, 25, 50, -1], [10, 25, 50, "All"] ],
            "pageLength": -1,

            "columns": [
                {
                    "className": 'details-control',
                    "orderable": false,
                    "data": null,
                    "defaultContent": '',
                    width:"15px"
                },
                { "data": "Type" },
                { "data": "Number" },
                { "data": "Title" },
                { "data": "Sponsor" },
                { "data": "Rule" },
                { "data": "Committee",
                    "visible" : false
                },
                { "data": "Context",
                    "visible" : false
                },
                { "data": "LCNum",
                    "visible" : false
                },
                { "data": "Summary",
                    "visible" : false
                },
                { "data": "Votes",
                    "visible" : false
                }
            ],
            "order": [[2, 'dsc']]
        });

        $( "#homebutton" ).click(function() {
            $( "#browseview" ).hide();
            $( "#aboutview" ).hide();
            $( "#homeview" ).show();
        });

        $( "#browsebutton" ).click(function() {
            $( "#homeview" ).hide();
            $( "#aboutview" ).hide();
            $( "#browseview" ).show();
        });

        $( "#aboutbutton" ).click(function() {
            $( "#browseview" ).hide();
            $( "#homeview" ).hide();
            $( "#aboutview" ).show();
        });

        $( "#bigaboutbutton" ).click(function() {
            $( "#browseview" ).hide();
            $( "#homeview" ).hide();
            $( "#aboutview" ).show();
        });

        // Add event listener for opening and closing details
        $('#reporttable tbody').on('click', 'td.details-control', function () {
            var tr = $(this).closest('tr');
            var tdi = tr.find("i.fa");
            var row = reporttable.row(tr);

            if (row.child.isShown()) {
                // This row is already open - close it
                row.child.hide();
                tr.removeClass('shown');
                tdi.first().removeClass('fa-minus-square');
                tdi.first().addClass('fa-plus-square');
            }
            else {
                // Open this row
                row.child(formatreport(row.data())).show();
                tr.addClass('shown');
                tdi.first().removeClass('fa-plus-square');
                tdi.first().addClass('fa-minus-square');
            }
        });

        // Add event listener for opening and closing details
         $('#example tbody').on('click', 'td.details-control', function () {
            var tr = $(this).closest('tr');
            var tdi = tr.find("i.fa");
            var row = table.row(tr);

            if (row.child.isShown()) {
                // This row is already open - close it
                row.child.hide();
                tr.removeClass('shown');
                tdi.first().removeClass('fa-minus-square');
                tdi.first().addClass('fa-plus-square');
            }
            else {
                // Open this row
                row.child(formatbrowse(row.data())).show();
                tr.addClass('shown');
                tdi.first().removeClass('fa-plus-square');
                tdi.first().addClass('fa-minus-square');
            }
        });

        table.on("user-select", function (e, dt, type, cell, originalEvent) {
            if ($(cell.node()).hasClass("details-control")) {
                e.preventDefault();
            }
        });

        
        reporttable.on("user-select", function (e, dt, type, cell, originalEvent) {
            if ($(cell.node()).hasClass("details-control")) {
                e.preventDefault();
            }
        });

        });

        function formatbrowse(d){

        // `d` is the original data object for the row
        return '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">' +
            '<tr>' +
                '<td>Full name:</td>' +
                '<td>' + d.Title + '</td>' +
            '</tr>' +
            '<tr>' +
                '<td>First Reader Summary:</td>' +
                '<td>' + d.Summary + '</td>' +
            '</tr>' +
            '<tr>' +
                '<td>First Reader Summary:</td>' +
                '<td>' + d.Summary + '</td>' +
            '</tr>' +
        '</table>';  
        }

        function formatreport(d){

        // `d` is the original data object for the row
        return '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">' +
            '<tr>' +
                '<td>Committee:</td>' +
                '<td>' + d.Committee + '</td>' +
            '</tr>' +
            '<tr>' +
                '<td>Context:</td>' +
                '<td>' + d.Context + '</td>' +
            '</tr>' +
            '<tr>' +
                '<td>LC Number:</td>' +
                '<td>' + d.LCNum + '</td>' +
            '</tr>' +
            '<tr>' +
                '<td>Summary:</td>' +
                '<td>' + d.Summary + '</td>' +
            '</tr>' +
            '<tr>' +
                '<td>Votes:</td>' +
                '<td>' + d.Votes + '</td>' +
            '</tr>' +
        '</table>';  
        }

        function gettext() {
            $.getJSON("https://spreadsheets.google.com/feeds/cells/11OXJaPQ4A01lCstNPAs6jOgAI1ZJHepxcqYdDZfF8Rk/2/public/full?alt=json", function(data) {
            console.log(data);
            whipreporttitle = data.feed.entry[1].content.$t;
            document.getElementById("whipereportitletext").textContent = whipreporttitle;
            whipreportdate = data.feed.entry[3].content.$t;
            document.getElementById("whipreportdatetext").textContent = whipreportdate;
            legislativeday = data.feed.entry[5].content.$t;
            document.getElementById("legislativedaytext").textContent = legislativeday;
            whipreportversion = data.feed.entry[7].content.$t;
            document.getElementById("whipreportversiontext").textContent = whipreportversion;
            whipreportlastupdated = data.feed.entry[9].content.$t;
            document.getElementById("whipreportlastupdatedtext").textContent = whipreportlastupdated;
            whipreportmessage = data.feed.entry[11].content.$t;
            document.getElementById("whipreportmessagetext").textContent = whipreportmessage;
            whipreportruletypes = data.feed.entry[13].content.$t;
            document.getElementById("whipreportruletypestext").textContent = whipreportruletypes;
            whipreporttabletitle = data.feed.entry[15].content.$t;
            document.getElementById("whipreporttabletitletext").textContent = whipreporttabletitle;
            });
        }


            
    </script>

    <title>GHDC E-Whip Report</title>
  </head>
  <body onload="gettext()">

    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
        <a class="navbar-brand" >
                 <img src="logo.jpg" height="80" class="d-inline-block align-center" alt=""> 
                E-Whip Report
                </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor03" aria-controls="navbarColor03" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      
        <div class="collapse navbar-collapse" id="navbarColor03">
          <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" id="homebutton" href="#" data-toggle="collapse" data-target="#navbarColor03" aria-controls="navbarColor03">Home</a>
           </li>
            <li class="nav-item">
              <a class="nav-link" id="browsebutton" href="#" data-toggle="collapse" data-target="#navbarColor03" aria-controls="navbarColor03">Browse</a>
            </li>
            <li class="nav-item" >
              <a class="nav-link" id="aboutbutton" href="#" data-toggle="collapse" data-target="#navbarColor03" aria-controls="navbarColor03">About</a>
            </li>
          </ul>
          <form class="form-inline my-2 my-lg-0">
            <div class="form-group">
                <select class="custom-select">
                  <option selected="">H.B.</option>
                  <option value="1">H.R.</option>
                  <option value="2">S.B.</option>
                  <option value="3">S.R.</option>
                </select>
              </div>
            <input class="form-control mr-sm-2" type="text" placeholder="Number">
            <button class="btn btn-secondary my-2 my-sm-0" type="submit">Go</button>
          </form>
        </div>
        </div>
      </nav>

   
    <div class="container" id="homeview" >
        <div class="alert alert-danger mb-4">
            <strong>Confidential</strong>  This website and its contents are confidential. Access is for members of the House Democratic Caucus only.
        </div>

        <div class="jumbotron">
                    <h1 id="whipereportitletext" class="display-3"></h1>
                         <div class="row">
                            <div class="col">
                                    <h2 id="whipreportdatetext" class=""></h2> 
                            </div>
                            <div class="col">
                                    <h2 id="legislativedaytext" class=""></h2>
                            </div>
                          </div>
                    
                          <div class="row">
                            <div class="col">
                                    <p id="whipreportlastupdatedtext"></p>
                            </div>
                            <div class="col">
                                    <p id="whipreportversiontext"></p>
                            </div>
                          </div>
                    
                          <strong id="whipreportmessagetext"></strong>
                    
                    <hr class="my-4">
                    
                    <p id="whipreportruletypestext"></p>

                    <hr class="my-4">

                    <p class="lead" >
                      <a class="btn btn-primary" id="bigaboutbutton" href="#" role="button" >About This Web App</a>
                    </p>
        </div>

        <h1 id="whipreporttabletitletext" class="mb-2"></h1>

        <table id="reporttable" class="display" cellspacing="0" width="100%">
                <thead>
                    <tr>
                        <th></th>
                        <th>Type</th>
                        <th>#</th>
                        <th>Title</th>
                        <th>Sponsor</th>
                        <th>Rule</th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                    </tr>
                </thead>
            </table>
        
        
        

    </div>

    <div class="container" id="browseview">
            <div class="alert alert-danger mb-4">
                <strong>Confidential</strong>  This website and its contents are confidential. Access is for members of the House Democratic Caucus only.
            </div>

        <table id="example" class="display" cellspacing="0" width="100%">
                <thead>
                    <tr>
                        <th></th>
                        <th>Type</th>
                        <th>#</th>
                        <th>Title</th>
                        <th>Sponsor</th>
                        <th>Status</th>
                        <th></th>
                        <th></th>
                    </tr>
                </thead>
            </table>

        </div>

    <div class="container" id="aboutview">
        <div class="alert alert-danger mb-4">
            <strong>Confidential</strong>  This website and its contents are confidential. Access is for members of the House Democratic Caucus only.
        </div>
            
        <p>wow!</p>

    </div>
    
  </body>
</html>